main_path=r'D:\20240103-(tunable PT via external coupling)'
#之前的数据
sub_pathes11=[
            r'20240119\1D spectrum 17-38-51',
            r'20240119\1D spectrum 17-51-50',
            r'20240119\1D spectrum 17-59-55',
            r'20240119\1D spectrum 18-7-44',
            r'20240119\1D spectrum 18-14-4',
            r'20240119\1D spectrum 18-20-53',
            r'20240119\1D spectrum 18-27-53',
            r'20240119\1D spectrum 18-38-16',
            r'20240119\1D spectrum 19-49-3',
            r'20240119\1D spectrum 19-56-30',
            r'20240119\1D spectrum 20-6-53',
            r'20240119\1D spectrum 20-14-20',
            r'20240119\1D spectrum 20-46-34',
            r'20240119\1D spectrum 21-2-43',
            r'20240119\1D spectrum 21-9-46',
            r'20240119\1D spectrum 21-24-25',
            r'20240119\1D spectrum 21-16-28',
            r'20240119\1D spectrum 21-31-16',
            r'20240119\1D spectrum 21-43-47',
            r'20240119\1D spectrum 21-50-10',
            r'20240119\1D spectrum 22-0-16',
            r'20240119\1D spectrum 22-7-4',
            r'20240119\1D spectrum 22-14-2',
            r'20240119\1D spectrum 22-21-7',
            r'20240119\1D spectrum 22-28-46',
            r'20240120\1D spectrum 13-14-50',
            r'20240120\1D spectrum 13-33-26',
            r'20240120\1D spectrum 13-41-54',
            r'20240120\1D spectrum 13-50-58',
            r'20240120\1D spectrum 14-1-44',
            r'20240120\1D spectrum 14-8-46',
            r'20240120\1D spectrum 14-18-58',
            r'20240120\1D spectrum 14-25-29',
            r'20240120\1D spectrum 14-34-34',
            r'20240120\1D spectrum 14-41-28',
            r'20240120\1D spectrum 14-48-44',
            r'20240120\1D spectrum 14-56-53',
            r'20240120\1D spectrum 15-8-6',
            r'20240120\1D spectrum 15-53-44',
            r'20240120\1D spectrum 16-0-15',
            r'20240120\1D spectrum 16-8-49',
            r'20240120\1D spectrum 16-17-10',
            r'20240120\1D spectrum 16-32-8',
            r'20240120\1D spectrum 16-44-55',
            r'20240120\1D spectrum 16-54-1',
            r'20240120\1D spectrum 17-5-49',
            r'20240120\1D spectrum 17-20-37',
            r'20240120\1D spectrum 17-29-12',
            r'20240120\1D spectrum 17-37-4',
            r'20240120\1D spectrum 17-45-31',
            r'20240120\1D spectrum 17-54-16',
            r'20240121\1D spectrum 15-20-11',
            r'20240121\1D spectrum 15-26-57',
            r'20240121\1D spectrum 15-35-10',
            r'20240121\1D spectrum 16-11-5',
            r'20240121\1D spectrum 16-21-21',
            r'20240121\1D spectrum 16-27-52',
            r'20240121\1D spectrum 16-35-4',
            r'20240121\1D spectrum 16-49-41',
            r'20240121\1D spectrum 17-1-37',
            r'20240121\1D spectrum 17-11-59',
            r'20240121\1D spectrum 17-23-56',
            r'20240121\1D spectrum 17-38-2',
            r'20240121\1D spectrum 17-53-28',
            r'20240121\1D spectrum 18-9-11',
            r'20240121\1D spectrum 19-17-36',
            r'20240121\1D spectrum 19-27-22',
            r'20240121\1D spectrum 19-34-0',
            r'20240121\1D spectrum 19-42-16',
            r'20240121\1D spectrum 19-50-39',
            r'20240121\1D spectrum 19-57-52',
            ]

sub_pathes12=[
    r'20240119/2D spectrum vs double voltage 17-24-52',
    r'20240119/2D spectrum vs double voltage 17-44-8',
    r'20240119/2D spectrum vs double voltage 17-54-10',
    r'20240119/2D spectrum vs double voltage 18-1-6',
    r'20240119/2D spectrum vs double voltage 18-8-39',
    r'20240119/2D spectrum vs double voltage 18-15-5',
    r'20240119/2D spectrum vs double voltage 18-21-38',
    r'20240119/2D spectrum vs double voltage 18-32-47',
    r'20240119/2D spectrum vs double voltage 19-42-51',
    r'20240119/2D spectrum vs double voltage 19-49-59',
    r'20240119/2D spectrum vs double voltage 19-57-21',
    r'20240119/2D spectrum vs double voltage 20-9-11',
    r'20240119/2D spectrum vs double voltage 20-39-52',
    r'20240119/2D spectrum vs double voltage 20-56-56',
    r'20240119/2D spectrum vs double voltage 21-3-31',
    r'20240119/2D spectrum vs double voltage 21-17-43',
    r'20240119/2D spectrum vs double voltage 21-10-51',
    r'20240119/2D spectrum vs double voltage 21-25-22',
    r'20240119/2D spectrum vs double voltage 21-32-0',
    r'20240119/2D spectrum vs double voltage 21-44-48',
    r'20240119/2D spectrum vs double voltage 21-52-15',
    r'20240119/2D spectrum vs double voltage 22-1-36',
    r'20240119/2D spectrum vs double voltage 22-8-42',
    r'20240119/2D spectrum vs double voltage 22-15-1',
    r'20240119/2D spectrum vs double voltage 22-22-12',
    r'20240120/2D spectrum vs double voltage 13-9-20',
    r'20240120/2D spectrum vs double voltage 13-26-9',
    r'20240120/2D spectrum vs double voltage 13-35-3',
    r'20240120/2D spectrum vs double voltage 13-43-6',
    r'20240120/2D spectrum vs double voltage 13-53-58',
    r'20240120/2D spectrum vs double voltage 14-2-55',
    r'20240120/2D spectrum vs double voltage 14-12-34',
    r'20240120/2D spectrum vs double voltage 14-20-0',
    r'20240120/2D spectrum vs double voltage 14-26-31',
    r'20240120/2D spectrum vs double voltage 14-35-42',
    r'20240120/2D spectrum vs double voltage 14-42-55',
    r'20240120/2D spectrum vs double voltage 14-50-30',
    r'20240120/2D spectrum vs double voltage 14-59-52',
    r'20240120/2D spectrum vs double voltage 15-47-54',
    r'20240120/2D spectrum vs double voltage 15-54-59',
    r'20240120/2D spectrum vs double voltage 16-1-40',
    r'20240120/2D spectrum vs double voltage 16-10-57',
    r'20240120/2D spectrum vs double voltage 16-23-33',
    r'20240120/2D spectrum vs double voltage 16-39-25',
    r'20240120/2D spectrum vs double voltage 16-47-13',
    r'20240120/2D spectrum vs double voltage 16-59-26',
    r'20240120/2D spectrum vs double voltage 17-15-12',
    r'20240120/2D spectrum vs double voltage 17-23-2',
    r'20240120/2D spectrum vs double voltage 17-30-49',
    r'20240120/2D spectrum vs double voltage 17-39-25',
    r'20240120/2D spectrum vs double voltage 17-48-5',
    r'20240121/2D spectrum vs double voltage 15-14-3',
    r'20240121/2D spectrum vs double voltage 15-21-42',
    r'20240121/2D spectrum vs double voltage 15-29-41',
    r'20240121/2D spectrum vs double voltage 16-5-56',
    r'20240121/2D spectrum vs double voltage 16-13-54',
    r'20240121/2D spectrum vs double voltage 16-22-38',
    r'20240121/2D spectrum vs double voltage 16-29-15',
    r'20240121/2D spectrum vs double voltage 16-43-36',
    r'20240121/2D spectrum vs double voltage 16-53-46',
    r'20240121/2D spectrum vs double voltage 17-6-23',
    r'20240121/2D spectrum vs double voltage 17-13-12',
    r'20240121/2D spectrum vs double voltage 17-31-57',
    r'20240121/2D spectrum vs double voltage 17-47-30',
    r'20240121/2D spectrum vs double voltage 18-3-50',
    r'20240121/2D spectrum vs double voltage 19-12-7',
    r'20240121/2D spectrum vs double voltage 19-21-16',
    r'20240121/2D spectrum vs double voltage 19-28-41',
    r'20240121/2D spectrum vs double voltage 19-36-41',
    r'20240121/2D spectrum vs double voltage 19-45-26',
    r'20240121/2D spectrum vs double voltage 19-51-58',
]

#上支耦合数据
#1D
sub_pathes21=[
            r'20240401\1D spectrum 14-44-18',
            r'20240401\1D spectrum 14-53-52',
            r'20240401\1D spectrum 15-0-59',
            r'20240401\1D spectrum 15-7-36',
            r'20240401\1D spectrum 15-17-40',
            r'20240401\1D spectrum 15-32-21',
            r'20240401\1D spectrum 21-54-31',
            r'20240401\1D spectrum 22-6-38',
            r'20240402\1D spectrum 15-9-4',
            r'20240402\1D spectrum 15-16-39',
            r'20240402\1D spectrum 15-25-1',
            r'20240402\1D spectrum 15-35-32',
            r'20240402\1D spectrum 15-47-34',
            r'20240402\1D spectrum 15-53-19',
            r'20240402\1D spectrum 15-59-8',
            r'20240402\1D spectrum 16-9-55',
            r'20240402\1D spectrum 16-15-53',
            r'20240402\1D spectrum 16-21-43',
            r'20240402\1D spectrum 16-28-15',
            r'20240402\1D spectrum 16-34-19',
            r'20240402\1D spectrum 16-40-42',
            r'20240402\1D spectrum 16-49-16',
            r'20240402\1D spectrum 16-55-25',
            r'20240402\1D spectrum 17-0-32',
            r'20240402\1D spectrum 17-5-34',
            r'20240402\1D spectrum 17-11-17',
            r'20240402\1D spectrum 17-17-29',
            r'20240403\1D spectrum 16-38-27',
            r'20240403\1D spectrum 16-45-8',
            r'20240403\1D spectrum 16-51-14',
            r'20240403\1D spectrum 16-57-2',
            r'20240403\1D spectrum 17-3-41',
            r'20240403\1D spectrum 19-3-16',
            r'20240403\1D spectrum 19-11-0',
            r'20240403\1D spectrum 19-16-3',
            r'20240403\1D spectrum 19-21-41',
            r'20240403\1D spectrum 19-26-42',
            r'20240403\1D spectrum 19-31-48',
            r'20240403\1D spectrum 19-37-39',
            r'20240403\1D spectrum 19-44-53',
            r'20240403\1D spectrum 19-50-5',
            r'20240403\1D spectrum 19-58-12',
            r'20240403\1D spectrum 20-3-41',
            r'20240403\1D spectrum 20-10-55',

            ]

#2D
sub_pathes22=[
    r'20240401\2D spectrum vs double voltage 14-38-57',
    r'20240401\2D spectrum vs double voltage 14-48-8',
    r'20240401\2D spectrum vs double voltage 14-55-45',
    r'20240401\2D spectrum vs double voltage 15-3-2',
    r'20240401\2D spectrum vs double voltage 15-9-5',
    r'20240401\2D spectrum vs double voltage 15-19-15',
    r'20240401\2D spectrum vs double voltage 21-49-56',
    r'20240401\2D spectrum vs double voltage 21-58-20',
    r'20240402\2D spectrum vs double voltage 15-4-21',
    r'20240402\2D spectrum vs double voltage 15-11-57',
    r'20240402\2D spectrum vs double voltage 15-20-9',
    r'20240402\2D spectrum vs double voltage 15-31-16',
    r'20240402\2D spectrum vs double voltage 15-42-55',
    r'20240402\2D spectrum vs double voltage 15-48-47',
    r'20240402\2D spectrum vs double voltage 15-54-53',
    r'20240402\2D spectrum vs double voltage 16-0-28',
    r'20240402\2D spectrum vs double voltage 16-11-12',
    r'20240402\2D spectrum vs double voltage 16-17-15',
    r'20240402\2D spectrum vs double voltage 16-23-39',
    r'20240402\2D spectrum vs double voltage 16-30-39',
    r'20240402\2D spectrum vs double voltage 16-35-45',
    r'20240402\2D spectrum vs double voltage 16-45-27',
    r'20240402\2D spectrum vs double voltage 16-50-52',
    r'20240402\2D spectrum vs double voltage 16-57-1',
    r'20240402\2D spectrum vs double voltage 17-1-57',
    r'20240402\2D spectrum vs double voltage 17-6-48',
    r'20240402\2D spectrum vs double voltage 17-13-2',
    r'20240403\2D spectrum vs double voltage 16-34-15',
    r'20240403\2D spectrum vs double voltage 16-39-47',
    r'20240403\2D spectrum vs double voltage 16-46-42',
    r'20240403\2D spectrum vs double voltage 16-52-30',
    r'20240403\2D spectrum vs double voltage 16-58-20',
    r'20240403\2D spectrum vs double voltage 18-58-59',
    r'20240403\2D spectrum vs double voltage 19-6-51',
    r'20240403\2D spectrum vs double voltage 19-12-11',
    r'20240403\2D spectrum vs double voltage 19-17-17',
    r'20240403\2D spectrum vs double voltage 19-23-1',
    r'20240403\2D spectrum vs double voltage 19-28-2',
    r'20240403\2D spectrum vs double voltage 19-33-37',
    r'20240403\2D spectrum vs double voltage 19-40-46',
    r'20240403\2D spectrum vs double voltage 19-46-13',
    r'20240403\2D spectrum vs double voltage 19-53-58',
    r'20240403\2D spectrum vs double voltage 19-59-38',
    r'20240403\2D spectrum vs double voltage 20-7-21',

]

#下支耦合数据
#1D
sub_pathes31=[
            r'20240407\1D spectrum 16-31-45',
            r'20240408\1D spectrum 14-52-0',
            r'20240408\1D spectrum 15-2-33',
            r'20240408\1D spectrum 15-12-2',
            r'20240408\1D spectrum 15-40-19',
            r'20240408\1D spectrum 15-38-4',
            r'20240408\1D spectrum 15-50-57',
            r'20240408\1D spectrum 15-59-43',
            r'20240408\1D spectrum 16-8-17',
            r'20240408\1D spectrum 16-21-36',
            r'20240408\1D spectrum 16-33-25',
            r'20240408\1D spectrum 16-43-49',
            r'20240408\1D spectrum 20-23-27',
            r'20240408\1D spectrum 20-42-7',
            r'20240408\1D spectrum 20-51-11',
            r'20240408\1D spectrum 21-1-8',
            r'20240408\1D spectrum 21-12-24',
            r'20240408\1D spectrum 21-21-13',
            r'20240408\1D spectrum 21-31-50',
            r'20240408\1D spectrum 21-42-7',
            r'20240408\1D spectrum 21-52-33',
            r'20240409\1D spectrum 15-13-49',
            r'20240409\1D spectrum 15-26-13',
            r'20240409\1D spectrum 15-38-53',
            r'20240409\1D spectrum 15-49-36',
            r'20240409\1D spectrum 16-2-10',
            r'20240409\1D spectrum 16-11-55',
            r'20240409\1D spectrum 16-22-15',
            r'20240409\1D spectrum 16-31-37',
            r'20240409\1D spectrum 16-47-35',
            r'20240409\1D spectrum 17-1-18',
            r'20240409\1D spectrum 17-10-48',
            r'20240409\1D spectrum 20-20-17',
            r'20240409\1D spectrum 20-39-29',
            r'20240409\1D spectrum 20-53-13',
            r'20240409\1D spectrum 21-7-20',
            r'20240409\1D spectrum 21-20-57',
            r'20240409\1D spectrum 21-35-47',
            r'20240409\1D spectrum 21-43-42',
            r'20240409\1D spectrum 22-0-28',
            r'20240409\1D spectrum 22-9-28',
            ]
#2D
sub_pathes32=[
    r'20240407\2D spectrum vs double voltage 16-22-37',
    r'20240408\2D spectrum vs double voltage 14-47-24',
    r'20240408\2D spectrum vs double voltage 14-57-32',
    r'20240408\2D spectrum vs double voltage 15-7-44',
    r'20240408\2D spectrum vs double voltage 15-21-27',
    r'20240408\2D spectrum vs double voltage 15-34-2',
    r'20240408\2D spectrum vs double voltage 15-46-38',
    r'20240408\2D spectrum vs double voltage 15-55-15',
    r'20240408\2D spectrum vs double voltage 16-4-7',
    r'20240408\2D spectrum vs double voltage 16-16-49',
    r'20240408\2D spectrum vs double voltage 16-29-7',
    r'20240408\2D spectrum vs double voltage 16-38-13',
    r'20240408\2D spectrum vs double voltage 20-19-37',
    r'20240408\2D spectrum vs double voltage 20-36-2',
    r'20240408\2D spectrum vs double voltage 20-46-22',
    r'20240408\2D spectrum vs double voltage 20-56-7',
    r'20240408\2D spectrum vs double voltage 21-8-21',
    r'20240408\2D spectrum vs double voltage 21-17-4',
    r'20240408\2D spectrum vs double voltage 21-27-1',
    r'20240408\2D spectrum vs double voltage 21-37-11',
    r'20240408\2D spectrum vs double voltage 21-48-47',
    r'20240409\2D spectrum vs double voltage 15-8-12',
    r'20240409\2D spectrum vs double voltage 15-22-49',
    r'20240409\2D spectrum vs double voltage 15-34-28',
    r'20240409\2D spectrum vs double voltage 15-44-49',
    r'20240409\2D spectrum vs double voltage 15-56-44',
    r'20240409\2D spectrum vs double voltage 16-7-24',
    r'20240409\2D spectrum vs double voltage 16-17-2',
    r'20240409\2D spectrum vs double voltage 16-27-22',
    r'20240409\2D spectrum vs double voltage 16-38-26',
    r'20240409\2D spectrum vs double voltage 16-56-33',
    r'20240409\2D spectrum vs double voltage 17-6-22',
    r'20240409\2D spectrum vs double voltage 20-15-44',
    r'20240409\2D spectrum vs double voltage 20-35-26',
    r'20240409\2D spectrum vs double voltage 20-49-0',
    r'20240409\2D spectrum vs double voltage 21-1-24',
    r'20240409\2D spectrum vs double voltage 21-14-1',
    r'20240409\2D spectrum vs double voltage 21-32-6',
    r'20240409\2D spectrum vs double voltage 21-40-9',
    r'20240409\2D spectrum vs double voltage 21-56-13',
    r'20240409\2D spectrum vs double voltage 22-5-38',
]

wp1=np.loadtxt(r'D:\20240103-(tunable PT via external coupling)\upper branch\upper branch omega1.txt')
wa=np.loadtxt(r'D:\20240103-(tunable PT via external coupling)\upper branch\omegaAp.txt')

S_2D=[]
fprint=np.linspace(-10,10,401)
for i in range(len(sub_pathes21)):
    sub_path1=sub_pathes21[i]
    mid_path1=os.path.join(main_path, sub_path1)
    fre1=ref().read_combation(mid_path1,r'vna fre.txt')
    S1=ref().read_combation(mid_path1,r'S11.txt')
    f_center=round(wp1[i],4)
    f_center_index = np.where(fre1==f_center)[0][0]
    f_start_index=f_center_index-201
    f_stop_index=f_center_index+200
    f_need=fre1[f_start_index:f_stop_index]
    S_need=S1[f_start_index:f_stop_index]
    S_2D.append(S_need)